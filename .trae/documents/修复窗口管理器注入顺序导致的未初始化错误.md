## 问题
- 在 packages/main/src/index.ts 中，`apiServer.setWindowManagers(windowManager, pluginWindowManager)` 在 `windowManager`/`pluginWindowManager` 定义之前调用，导致主进程抛出 ReferenceError。

## 修复方案
- 调整调用顺序：先实例化 `windowManager` 与 `pluginWindowManager`，再调用 `apiServer.setWindowManagers(...)`，最后 `await apiServer.start()`。
- 仅移动代码，无其他逻辑变更；不保留回退代码。

## 变更点
- 修改 packages/main/src/index.ts：
  - 删除当前在 179–181 的注入调用位置
  - 在 185–186（两者实例化之后）插入 `apiServer.setWindowManagers(windowManager, pluginWindowManager)`
  - 确保 `await apiServer.start()` 位于注入完成之后

## 验证
- 编译通过；主进程启动不再出现 `Cannot access 'windowManager... before initialization` 错误。
- Window/popup HTTP 接口保持可用。