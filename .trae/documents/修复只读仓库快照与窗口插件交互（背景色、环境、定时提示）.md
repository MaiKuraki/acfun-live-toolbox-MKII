## 目标
- 只读仓库快照中移除 `plugin` 字段（UI/Window/Overlay 三端接收的 init/update 数据）
- 修复窗口插件“保存背景色”不生效
- 解决 index.js 环境变量获取失效
- 修复定时提示开关点击无响应

## 改动概览
- 只读仓库快照过滤：
  - 修改后端 SSE 发包与初始聚合：在 `ApiServer.ts` 发送 `data:` 前对快照对象和增量对象统一删除顶层 `plugin` 字段
  - 可选增强：渲染侧 `readonlyReporter.sanitize` 也删除顶层 `plugin` 字段，双重保障
- 窗口插件背景色保存：
  - 在 `WindowFramePluginPage.vue` 中补充缺失的 `sendLifecycleEvent` 函数（当前 `set-config` 分支调用该函数但未定义，导致不会广播 `config-updated`）
  - 保持 `bridge-request: set-config` → `window.electronApi.plugin.updateConfig` 路径不变，修复后会触发子页重新拉取配置并应用背景色
- index.js 环境变量与定时提示：
  - 在 preload 暴露 `plugin.process` 桥接（`execute(pluginId, method, args)`、`message(pluginId, type, payload)`），对应主进程 IPC `plugin.process.execute/message`
  - 窗口容器页已实现 `plugin-process` 桥接转发；完成 preload 后子页调用将有响应

## 详细实现
1) ApiServer 只读仓库过滤（后端）
- 文件：`packages/main/src/server/ApiServer.ts`
- 位置：
  - SSE `sendRecord`：`data: JSON.stringify(payload && payload.payload)` 前，对 `payload.payload` 执行删除 `plugin` 字段
  - 初始快照聚合：构造 `snapshot` 完成后，删除 `snapshot.plugin`
- 目的：保证所有订阅方收到的数据不含 `plugin` 切片

2) 渲染侧只读上报（可选）
- 文件：`packages/renderer/src/utils/readonlyReporter.ts`
- 在 `sanitize()` 中追加顶层 `plugin` 删除逻辑（当前仅去除 token/accessToken/refreshToken）。此步为增强，不依赖但可提升一致性

3) 修复窗口背景色保存不生效
- 文件：`packages/renderer/src/pages/WindowFramePluginPage.vue`
- 添加：
  - `sendLifecycleEvent(event: string)` 使用现有 `emitToChild` 向子页广播 `{ type:'plugin-event', eventType:'lifecycle', event }`
- 现成逻辑：`set-config` 成功后调用 `sendLifecycleEvent('config-updated')` → 子页收到并触发 `get-config`、`applyBg`

4) 预加载层新增 plugin.process 桥接
- 文件：`packages/preload/src/index.ts`
- 在 `api.plugin` 下增加：
  - `process: { execute: (pluginId, method, args) => ipcRenderer.invoke('plugin.process.execute', pluginId, method, args), message: (...) => ipcRenderer.invoke('plugin.process.message', pluginId, type, payload) }`
- 目的：使窗口子页通过外部 Frame 的 `plugin-process` 桥接能真正触发主进程执行 index.js 方法并返回数据

## 验证
- 类型检查：`pnpm typecheck`
- 手工验证：
  - 打开窗口页，修改背景色并保存，页面即刻变更
  - 点击“获取环境变量”，能看到 Node 版本和内存占用
  - 点击“定时提示开关”，主窗口每 3 秒弹 toast；再次点击停止
  - UI/Window/Overlay 接收的只读仓库数据中不再出现 `plugin` 字段

## 兼容与安全
- 不影响生产托管，改动仅涉及 SSE输出对象结构过滤
- 不改动 acfunlive-http-api，不使用 mock
- 预加载新增 API 与既有主进程 IPC 对应，遵循现有通道命名风格