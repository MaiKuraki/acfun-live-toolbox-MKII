**问题根因**

* 启用 `sample-overlay-window` 时调用 `path.join(plugin.installPath, plugin.manifest.main)`，`manifest.main` 未定义导致抛错。位置：`packages/main/src/plugins/PluginManager.ts:922`。

* 示例清单缺少 `main` 字段，仅声明了 `window` 托管：`buildResources/plugins/sample-overlay-window/manifest.json:1-12`。

* 当前安装校验强制要求 `main`，不兼容仅 UI/Window/Overlay 的纯静态插件：`packages/main/src/plugins/PluginManager.ts:1156-1159, 1174-1177`。

**修复方案**

* 更新启用流程以支持“无进程静态插件”：

  * 在 `enablePlugin` 中先判断：`hasProcessMain = typeof manifest.main === 'string' && manifest.main.trim() !== ''`；`hasStaticHosting = !!(manifest.ui || (manifest as any).window || manifest.overlay)`。

  * 当 `!hasProcessMain && hasStaticHosting` 时：跳过进程启动，直接标记启用并持久化，同时执行生命周期钩子与事件。

    * 变更位置：`packages/main/src/plugins/PluginManager.ts:918-977`（在计算 `pluginMainPath` 前插入分支并 `return`）。

    * 设置：`plugin.enabled = true; plugin.status = 'enabled'; plugin.lastError = undefined;`；写入 `configManager.set('plugins.${id}', { enabled: true, installedAt })`；`this.emit('plugin.enabled', { id })`；调用 `beforeEnable`/`afterEnable` 保持行为一致。

* 放宽清单验证规则以允许静态插件：

  * 仅当缺少 `main` 且也未声明 `ui/window/overlay` 时才报错。

  * 变更位置：`packages/main/src/plugins/PluginManager.ts:1156-1159` 改为：

    * 必需字段：`id/name/version`；满足其一：`main` 存在 或 `ui/window/overlay` 至少声明一个。

  * 主文件存在性检查仅在 `hasProcessMain` 为真时进行（保护 `packages/main/src/plugins/PluginManager.ts:1174-1177`）。

* 微调内置示例修复逻辑，避免对纯静态插件强行假设 `index.js`：

  * 在 `installBundledExamplesIfMissing` 的“修复主入口”段仅在 `manifestJson.main` 为字符串时进行复制。

  * 变更位置：`packages/main/src/plugins/PluginManager.ts:444-457`。

**验证步骤**

* 开发模式运行后，进入插件管理页开启 `sample-overlay-window`：

  * 期望不再出现 `ERR_INVALID_ARG_TYPE`；前端日志显示启用成功（`PluginManagementPage.vue` 正常 toast）。

  * `renderer` 侧会在启用后根据清单自动注册路由（`packages/renderer/src/stores/plugin.ts:550-553, 662-679`）。

  * 访问 `http://127.0.0.1:<ACFRAME_API_PORT>/plugins/sample-overlay-window/window` 可正确返回页面（`packages/main/src/server/ApiServer.ts:523-656`）。

* 回归测试：

  * 仍带有 `main` 的进程型插件应照常启动进程（`enablePlugin` 原逻辑未变）。

  * 安装校验：带 `main` 的压缩包继续严格校验；仅静态托管插件压缩包可通过新规则。

**注意事项**

* 保持生命周期钩子一致性：静态插件也会触发 `beforeEnable/afterEnable/onError`。

* 安全性：`ApiServer` 的静态托管路径限制未变，仍校验根目录与禁用态访问（`packages/main/src/server/ApiServer.ts:545-605`）。

* 无需变更前端逻辑：前端通过 `hosting.getConfig` 与路由注册已支持 `window/ui/overlay`（`packages/preload/src/index.ts:105-121`、`packages/renderer/src/utils/hosting.ts:21-74`）。

