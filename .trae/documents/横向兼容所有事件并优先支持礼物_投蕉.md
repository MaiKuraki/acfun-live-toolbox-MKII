## 目标
- 兼容 `danmuInfo` 包装和根级字段组合，正确识别礼物/投蕉、点赞、进入、评论等事件类型，并路由到统一事件与写库。

## 方案
1. 合并父事件与 `danmuInfo`：
- 在 `handleDanmuEvent` 中调用 `processDanmuInfo(event.danmuInfo, event)`，将父事件的根级字段（如 `giftDetail/count/combo/value`）与 `danmuInfo` 一并解析。

2. 解析器增强：
- 修改 `processDanmuInfo(di, parent)`：
  - 若 `di.payload` 为数组，逐条路由到 `handleActionSignal`，并合并父事件字段。
  - 否则组装一个 ActionSignal，字段来源优先级：`parent` → `di`。

3. 类型判定增强（`handleActionSignal`）：
- 当 `signalType` 为空时，基于字段特征判定：
  - 礼物/投蕉：`giftDetail/giftId/giftName/gift` → type `gift`，从 `giftDetail.name/giftName` 与 `count` 组装内容；若有 `value/combo` 一并纳入内容。
  - 点赞：`likeCount/likeDelta/totalLike` → type `like`
  - 进入：仅有用户字段 → type `enter`
  - 评论：`comment/content/message/text` → type `comment`
- 然后路由到对应处理器，使 RoomManager 与 EventWriter 得到统一事件，触发写库。

## 验证
- 触发“投蕉/送礼/点赞/进入/评论”事件：
  - 观察 `[Adapter] ActionSignal type=gift/like/enter/comment ...]` → `[Room] unified ...]` → `[DB] insert ...]` → `[Writer] commit ok ...]`
- `/api/events` 返回多类型事件。