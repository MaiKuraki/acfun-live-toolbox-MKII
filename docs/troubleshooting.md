# 故障排除

本指南帮助您诊断和解决 ACLiveFrame 使用过程中可能遇到的问题。

## 🔍 诊断工具

### 日志位置
- **应用日志**: `%APPDATA%/ACLiveFrame/logs/`
- **插件日志**: 应用内插件管理页面查看
- **控制台日志**: 按 F12 打开开发者工具
- **诊断报告**: 菜单 → 帮助 → 生成诊断报告

### 基本诊断步骤
1. 检查网络连接是否正常
2. 确认 AcFun 服务是否可访问
3. 查看应用和控制台日志
4. 重启应用尝试解决问题

## 🚨 常见问题

### 连接问题

#### 无法连接到直播间
**症状**: 无法连接到指定的直播间或获取数据
**解决方案**:
1. 检查网络连接状态
2. 验证房间ID是否正确
3. 确认直播间是否存在且正在直播
4. 查看控制台错误日志
5. 尝试重启应用

#### 连接频繁断开
**症状**: 连接不稳定，频繁出现断开重连
**解决方案**:
1. 检查网络稳定性
2. 减少同时连接的房间数量
3. 调整连接超时设置
4. 查看是否有网络防火墙阻拦

### 认证问题

#### 登录失败或令牌过期
**症状**: 无法登录或认证信息失效
**解决方案**:
1. 重新进行二维码登录
2. 清除旧的认证信息缓存
3. 检查 AcFun 账号状态是否正常
4. 确认网络可以访问 AcFun 服务
5. 尝试使用不同的设备进行登录

#### 二维码登录无响应
**症状**: 扫描二维码后没有反应
**解决方案**:
1. 确认使用的是 AcFun 官方客户端
2. 检查手机和电脑是否在同一网络
3. 尝试刷新二维码
4. 使用手动配置认证信息

### 性能问题

#### 应用运行缓慢或内存占用过高
**症状**: 界面卡顿、响应慢或内存使用异常
**解决方案**:
1. 减少同时连接的房间数量
2. 调整事件处理批次大小
3. 清理过期的缓存数据
4. 重启应用释放资源
5. 检查是否有插件造成内存泄漏

#### 数据处理延迟
**症状**: 弹幕或礼物数据处理延迟
**解决方案**:
1. 降低数据处理频率
2. 优化插件的数据处理逻辑
3. 检查数据库查询性能
4. 考虑增加系统资源

### 插件问题

#### 插件无法加载
**症状**: 插件安装后无法正常工作
**解决方案**:
1. 检查插件文件是否完整
2. 验证插件配置是否正确
3. 查看插件兼容性版本
4. 检查插件依赖是否满足
5. 查看插件日志输出

#### 插件运行异常
**症状**: 插件功能不正常或报错
**解决方案**:
1. 更新插件到最新版本
2. 检查插件配置参数
3. 查看插件开发者文档
4. 联系插件开发者获取支持

## 🔧 高级诊断

### 网络诊断

```bash
# 测试 AcFun API 连接
curl -I https://live.acfun.cn/

# 测试本地 API 服务
curl http://127.0.0.1:1299/api/status
```

### 数据库诊断

```bash
# 检查数据库文件
ls -la ~/AppData/Roaming/ACLiveFrame/events.db

# 查看数据库大小
du -h ~/AppData/Roaming/ACLiveFrame/events.db
```

### 系统资源监控

```bash
# Windows 资源监控
taskmgr

# 检查端口占用
netstat -ano | findstr :1299
```

## 📊 数据查询问题

### 查询无结果
**可能原因**:
- 时间范围设置不正确
- 用户名关键词匹配失败
- 房间数据不存在
- 数据库损坏

**解决方案**:
1. 扩大时间查询范围
2. 检查关键词拼写
3. 验证房间ID格式
4. 尝试重建数据库索引

### 查询性能慢
**优化建议**:
1. 使用更精确的查询条件
2. 添加合适的索引
3. 分批查询大量数据
4. 优化查询频率

## 🚀 性能调优

### 内存优化
- 定期清理缓存数据
- 限制同时运行的插件数量
- 监控内存使用趋势
- 及时重启应用释放资源

### 网络优化
- 使用稳定的网络连接
- 避免频繁的 API 调用
- 合理设置连接超时
- 使用连接池复用

### 存储优化
- 定期清理过期数据
- 优化数据库查询
- 使用适当的索引
- 监控存储空间使用

## 🆘 获取帮助

如果以上方法都无法解决问题：

1. **收集诊断信息**:
   - 生成完整的诊断报告
   - 记录问题发生的详细步骤
   - 提供相关的日志文件

2. **提交问题报告**:
   - [GitHub Issues](https://github.com/your-org/ACLiveFrame/issues)
   - 提供详细的问题描述和诊断信息

3. **寻求社区帮助**:
   - 查看已有的问题解决方案
   - 参与社区讨论获取帮助

## 🔄 恢复和重置

### 软重置
1. 清除应用缓存和临时文件
2. 重启应用和服务
3. 重新登录账号

### 硬重置
1. 备份重要数据和配置
2. 完全卸载应用
3. 清理残留文件和配置
4. 重新安装和配置

### 数据恢复
- 从备份恢复配置
- 重新同步缺失的数据
- 验证数据完整性

---

<div align="center">
  <p>问题解决了吗？</p>
  <p>🚀 <a href="quickstart.md">返回快速开始</a> | 🏗️ <a href="architecture.md">了解架构</a> | 🤝 <a href="contributing.md">贡献代码</a></p>
</div>
